Object.extend(String.prototype,{replaceInit:function(){return this.space().trim().replace(/$/g,"\n").replace(/\n{2,}/gm,"\n").replace(/([a-zA-Z])(['`\uff07\u2018\u2019\u300e\u300f])([a-zA-Z])/g,"$1'$3").replace(/^\u300d/gm,"\u300c").replace(/^\u300f/gm,"\u300e").replace(/^\u201d/gm,"\u201c").replace(/^\u2019/gm,"\u2018").replace(/\u300c$/gm,"\u300d").replace(/\u300e$/gm,"\u300f").replace(/\u201c$/gm,"\u201d").replace(/\u2018$/gm,"\u2019")},replaceEnd:function(){return this.replace(/^\u300d/gm,"\u300c").replace(/^\u300f/gm,
"\u300e").replace(/^\u201d/gm,"\u201c").replace(/^\u2019/gm,"\u2018").replace(/\u300c$/gm,"\u300d").replace(/\u300e$/gm,"\u300f").replace(/\u201c$/gm,"\u201d").replace(/\u2018$/gm,"\u2019").replace(/\n{3,}/gm,"\n\n").replace(/^\n+/g,"")},convertInitial:function(){for(var a=this.toLowerCase().toUpper(/\b([a-zA-Z])/g,!0).replace(/[\u300a\u201c\u2018\u300c\u300e\u3010"\uff08]([\w \uff01\uff08\uff09\uff0c\uff1a\uff1b\uff1f\u2013\u2026\u3002\uff06\uff20\uff03!\(\),:;\?\-\.&@#'\n]{2,})[\u300b\u201d\u2019\u300d\u3011\u300f"\uff09]/g,
function(a,b){return b.match(/([\u2026\uff01\uff1f\u3002!\?\.]$|[\uff0c\uff1a\uff1b\uff06,:;&'])/g)&&b.match(/\w/g)?a.toUpper(/[\uff0c, ][A-Z]/g,!1).replaces(configs.halfSymbol).toUpper(/[\.\?!:&][ ]?[a-z]/g,!0):a}).replace(/^([\w \uff01\uff08\uff09\uff0c\uff1a\uff1b\uff1f\u2013\u2026\u3002\uff06\uff20\uff03!\(\),:;\?\-\.&@#']{2,})$/gm,function(a){return a.toUpper(/[\uff0c ][A-Z]/g,!1)}).replace(/\b([\w\-~\uff5e]+)\b/g,function(a){return a.match(/\d/)?a.toUpperCase():a}).toUpper(/\b(a{2,}|b{2,}|c{2,}|d{2,}|e{2,}|f{2,}|g{2,}|h{2,}|i{2,}|j{2,}|k{2,}|l{2,}|m{2,}|n{2,}|o{2,}|p{2,}|q{2,}|r{2,}|s{2,}|t{2,}|u{2,}|v{2,}|w{2,}|x{2,}|y{2,}|z{2,})\b/gi,
!0).replace(/([a-zA-Z]+)['`\uff07\u2018\u2019\u300e\u300f]([a-zA-Z]+)/g,function(a,b,d){return b.toUpper(/\b[a-z]/g,!0)+"'"+d.toLowerCase()}).replace(/([0-9a-zA-Z]+)[\u3002\.]([0-9a-zA-Z\u2014\-_]+)[\u3002\.](com|net|org|gov)/gi,function(a){return a.replace(/\u3002/g,".").toLowerCase()}),b=configs.pWord.split("|"),d=0;d<b.length;d++)a=a.replace(new RegExp("\\b("+b[d]+")([0-9]*)\\b","gi"),b[d]+"$2");return a},convertNumberLetter:function(a){return this.convertLetter(a).convertNumber(a).replaces(configs.nwSymbol)},
convertDBCNumber:function(){return this.replace(/[\uFF10-\uFF19]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)})},convertNumber:function(a){return 1===a?this.replace(/[\u0030-\u0039]/g,function(a){return String.fromCharCode(a.charCodeAt(0)+65248)}).replace(new RegExp(configs.regSBCNumberTitle,"g"),function(a){return a.convertDBCNumber()}):this.convertDBCNumber()},convertLetter:function(a){var b=this.replace(/([\uFF41-\uFF5A])([\uFF21-\uFF3A])/g,"$1 $2");return 1===a?b.replace(/[a-zA-Z]/g,
function(a){return String.fromCharCode(a.charCodeAt(0)+65248)}):b.replace(/[\uFF41-\uFF5A\uFF21-\uFF3A]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)})},converUnicode:function(){return this.replace(/\\u?([0-9a-f]{4})/gi,function(a){return unescape(a.replace(/\\u?/gi,"%u"))}).replace(/([\uff06&]#(\d+)[;\uff1b])/gi,function(a){return String.fromCharCode(a.replace(/[\uff06&#;\uff1b]/g,""))})},converHtmlEntity:function(){return this.replace(configs.regHtmlEntity,function(a,b){return configs.sHtmlEntity[b]||
a})},convertVariant:function(){return this.replaces(configs.sVariant)},convertSerialNumber:function(){return this.replaces(configs.sSerialNumber)},convertPunctuation:function(){return this.replaces(configs.punSymbol).replaces(configs.nwSymbol)},replaceSpace:function(){return this.replace(/[\t]+(?=[\u4e00-\u9fa0])/g,"\n").replace(/[ ]+/g," ").replace(/[ ]+(?=[\u4e00-\u9fa0\u00b7\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2013\u2014\u2018\u2019\u201c\u201d\u2026\u3001\u3002\u3008-\u3011\u3014\u3015\uffe0-\uffe5\uff06\/\\\+\-'])/g,
"").replace(/([0-9a-zA-Z])[ ]+([\u4e00-\u9fa0\u00b7\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2013\u2014\u2018\u2019\u201c\u201d\u2026\u3001\u3002\u3008-\u3011\u3014\u3015\uffe0-\uffe5\uff06])/g,"$1$2").replace(/([\u4e00-\u9fa0\u00b7\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2013\u2014\u2018\u2019\u201c\u201d\u2026\u3001\u3002\u3008-\u3011\u3014\u3015\uffe0-\uffe5\uff06])[ ]+([0-9a-zA-Z])/g,"$1$2")},replaceSeparator:function(){return this.replaces(configs.rSeparator).replace(/!@!@!@!@!/g,
"\uff0a".times(35)).replace(/@@@@/g,configs.Separator)},replaceQuotes:function(a,b){a=("cn"!==a?"\u2018\u2019\u201c\u201d":"\u300e\u300f\u300c\u300d").split("");b=b||!1;var d=this.replace(/([a-zA-z])(['`\uff07\u2018\u2019\u300e\u300f])([a-zA-z])/g,"$1\u203b@\u203b$3");b||(d=d.replace(/[\u2018\u2019\u300e\u300f]/g,"'").replace(/[\u201c\u201d\u300c\u300d]/g,'"'));return d.replace(/[`\uff07]/g,"'").replace(/[\u301d\u301e\uff3b\uff3d\uff02\u2033\uff62\uff63]/g,'"').replace(/'([^'\r\n]+)'/g,a[0]+"$1"+
a[1]).replace(/^([\u3000]+)'/gm,"$1"+a[0]).replace(/'/g,a[1]).replace(new RegExp("^([\u3000]*)"+a[1],"gm"),"$1"+a[0]).replace(new RegExp(a[0]+"$","gm"),a[1]).replace(/\u203b@\u203b/g,"'").replace(/"([^"\r\n]+)"/g,a[2]+"$1"+a[3]).replace(/^([\u3000]+)"/gm,"$1"+a[2]).replace(/"/g,a[3]).replace(new RegExp("^([\u3000]*)"+a[3],"gm"),"$1"+a[2]).replace(new RegExp(a[2]+"$","gm"),a[3]).replace(new RegExp("\uff1a"+a[3],"g"),"\uff1a"+a[2])},toTitleCenter:function(a,b,d){var e=2*configs.Linenum,f=this.trim();
if(!0===d){var g=f.len(),c=0===g%4?" ":"";d&&e>g&&(f="\u3000".times(parseInt((e-g)/4,10))+c+f)}return(a||"\n")+f+(b||"")},replaceBorder:function(a){var b=configs.regTitle;b.t=a;b.b=configs.regTitleBorder;a="^{$f}[{$b.0}]?({$t})[{$b.1}]?({$s})?[{$b.0}]?({$e}|$)[{$b.1}]?$".fmt(b);return this.replace(a.getReg("gm"),function(a){return a.replace(("["+b.b.join("")+"]").getReg("gm"),"")})},replaceTitle:function(a,b,d,e){var f=a||"\n\n",g=b||"";a=this;var c=configs.regTitle,l=("^"+c.s).getReg("g"),n=("^"+
c.s+"$").getReg("g");!0===e&&(c.s=c.sn,c.es=c.e);!0===d&&(a=a.replace((c.f+configs.Separator).getReg("gm"),function(a){return a.toTitleCenter("","",!0)}));var h=function(a,b){if(0==a.length)return"";b=b?!1:!0;a=a.replace(/[ ]{1,}/g," ").replace(l,"").replace(/([\u4E00-\u9FA5]{2,})[ ]([\u4E00-\u9FA5]{2,})/g,"$1\uff0c$2").replace(/([\u4E00-\u9FA5])[ ]([\u4E00-\u9FA5])/g,"$1$2").replace(/(\w+)[ ]{1,4}(\w+)/g,"$1 $2").replace(n,"");return 0<a.length&&b?configs.Divide+a:a};e=function(a,b){return new RegExp(a.fmt(c,
b),"gim")};b=e("^{$f}({$t1})(?:{$sn})({$e}|$)$","|");a=a.replaceBorder(c.t1.join("|")).replace(b,function(a,b,k){return k.match(/^[\uff01\uff1f\u3002]{1,3}$/g)?a:(b+h(k)).toTitleCenter(f,g,d)});b=e("^{$f}{$t2}({$sn})({$e}|$)$");a=a.replaceBorder(c.t2).replace(b,function(a,b,k,c){return k.match(/^[\-\u2014]{1,4}/g)||c.match(/^[\uff01\uff1f\u3002\u2026]{1,3}$/g)||!k.match(l)&&c.match(/[\uff0c]|[\uff01\uff1f\u3002\u2026]{1,3}$/g)||a.match(configs.regSkipTitle)&&!k.match(l)&&c.match(/[\uff01\uff1f\u3002\u2026]{1,3}$/g)?
a:("\u7b2c"+b.replace(/(^[\u7b2c]+| )/g,"")+h(c)).toTitleCenter(f,g,d)});b=e("^{$f}{$t5}({$e}|$)$");a=a.replaceBorder(c.t5).replace(b,function(a,b,c){return(b+h(c,"no")).toTitleCenter(f,g,d)});if(!0===d)return a;b=e("^{$f}{$t3}(?:{$sn})({$e}|$)$");a=a.replaceBorder(c.t3).replace(b,function(a,b,c,d){return f+"\u7b2c"+c+b+h(d)+g});b=e("^{$f}{$t6}(?:{$s})({$e}|$)$");a=a.replaceBorder(c.t6).replace(b,function(a,b,c){return f+"\u7b2c"+b+"\u7ae0"+h(c)+g});var m=configs.regSkipTitle1;b=e("^{$f}{$t4}({$s}|{$s}{$e}|$)$");
return a=a.replaceBorder(c.t4).replace(b,function(a,b,c){if(c.match(/^[\uff01\uff1f\u3002\u2026]{1,3}$/g)||!c.match(l)&&c.match(/[\uff01\uff1f\u3002\u2026]$/g))return a;for(var d=0;d<m.length;d++)if(a.match(m[d]))return a;return f+"\u7b2c"+b+"\u7ae0"+h(c)+g})}});
