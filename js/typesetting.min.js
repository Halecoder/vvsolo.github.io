Object.extend=function(a,d){for(var b in d)a[b]=d[b];return a};
Object.extend(String.prototype,{replaces:function(a){var d=this,b;for(b in a)d=d.replace(a[b][0],a[b][1]);return d},times:function(a){return 1>a?"":Array(a+1).join(this)},checkEmpty:function(){return 0===this.replace(configs.AllSpace,"").length},len:function(){return this.replace(/[^\x00-\xff]/g,"**").length},realSubstring:function(a,d){var b=this||"";if(0===b.length)return b;a=a||0;d=d||b.len();for(var e=0,h="",g=c=cl=0;g<b.length;g++)if(c=b.charCodeAt(g),cl=255<c?2:1,e+=cl,!(a>=e))if(d==b.len()||
0<=(d-=cl))h+=String.fromCharCode(c);else break;return h},trim:function(a){return this.replace(configs.trim,a||"")},replaceInit:function(){return this.replace(configs.Space," ").trim("\n").replace(/(\r\n|\n\r|\r)/g,"\n").replace(/$/g,"\n").replace(/([a-zA-Z])(['`\uff07\u2018\u2019\u300e\u300f])([a-zA-Z])/g,"$1'$3").replace(/^\u300d/gm,"\u300c").replace(/^\u300f/gm,"\u300e").replace(/^\u201d/gm,"\u201c").replace(/^\u2019/gm,"\u2018").replace(/\u300c$/gm,"\u300d").replace(/\u300e$/gm,"\u300f").replace(/\u201c$/gm,
"\u201d").replace(/\u2018$/gm,"\u2019").replace(/\n{2,}/gm,"\n")},replaceEnd:function(){return this.replace(/^\u300d/gm,"\u300c").replace(/^\u300f/gm,"\u300e").replace(/^\u201d/gm,"\u201c").replace(/^\u2019/gm,"\u2018").replace(/\u300c$/gm,"\u300d").replace(/\u300e$/gm,"\u300f").replace(/\u201c$/gm,"\u201d").replace(/\u2018$/gm,"\u2019").replace(/\n{3,}/gm,"\n\n").replace(/^\n+/g,"")},convertInitial:function(){for(var a=this.toLowerCase().replace(/\b([a-zA-Z])/g,function(a){return a.toUpperCase()}).replace(/[\u300a\u201c\u2018\u300c\u300e\u3010"\uff08]([\w \uff01\uff08\uff09\uff0c\uff1a\uff1b\uff1f\u2013\u2026\u3002\uff06\uff20\uff03!\(\),:;\?\-\.&@#'\n]{2,})[\u300b\u201d\u2019\u300d\u3011\u300f"\uff09]/gm,
function(a,b){return(b.match(/[\u2026\uff01\uff1f\u3002!\?\.]$/g)||b.match(/[\uff0c\uff1a\uff1b\uff06,:;&']/g))&&b.match(/\w/g)?a.replace(/[\uff0c, ][A-Z]/g,function(a){return a.toLowerCase()}).replaces(configs.halfSymbol).replace(/[\.\?!:&][ ]?[a-z]/g,function(a){return a.toUpperCase()}):a}).replace(/^([\w \uff01\uff08\uff09\uff0c\uff1a\uff1b\uff1f\u2013\u2026\u3002\uff06\uff20\uff03!\(\),:;\?\-\.&@#']{2,})$/gm,function(a,b){return a.replace(/[\uff0c ][A-Z]/g,function(a){return a.toLowerCase()})}).replace(/\b([A-Za-z\d]+)\b/g,
function(a){return a.match(/\d/)?a.toUpperCase():a}).replace(/([a-zA-Z]+[\-\u2014~\uff5e]\d|\d[\-\u2014~\uff5e][a-zA-Z]+)/g,function(a){return a.toUpperCase()}).replace(/([a-zA-Z]+)['`\uff07\u2018\u2019\u300e\u300f]([a-zA-Z])/g,function(a,b,d){return b.replace(/\b[a-z]/g,function(a){return a.toUpperCase()})+"'"+d.toLowerCase()}).replace(/([0-9a-zA-Z]+)[\u3002\.]([0-9a-zA-Z\u2014\-_]+)[\u3002\.](com|net|org|gov)/gi,function(a){return a.replace(/\u3002/g,".").toLowerCase()}),d=configs.pWord.split("|"),
b=0;b<d.length;b++)a=a.replace(new RegExp("\\b("+d[b]+")([0-9]*)\\b","gi"),d[b]+"$2");return a},convertNumberLetter:function(a){return this.convertLetter(a).convertNumber(a).replaces(configs.nwSymbol)},convertDBCNumber:function(){return this.replace(/[\uFF10-\uFF19]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)})},convertNumber:function(a){return 1===a?this.replace(/[\u0030-\u0039]/g,function(a){return String.fromCharCode(a.charCodeAt(0)+65248)}).replace(configs.regSBCNumberTitle,
function(a){return a.convertDBCNumber()}):this.convertDBCNumber()},convertLetter:function(a){var d=this.replace(/([\uFF41-\uFF5A])([\uFF21-\uFF3A])/g,"$1 $2");return 1===a?d.replace(/[a-zA-Z]/g,function(a){return String.fromCharCode(a.charCodeAt(0)+65248)}):d.replace(/[\uFF41-\uFF5A\uFF21-\uFF3A]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)})},converUnicode:function(){return this.replace(/\\u?([0-9abcdef]{4})/gi,function(a){return unescape(a.replace(/\\u?/gi,"%u"))}).replace(/([\uff06&]#(\d+)[;\uff1b])/gi,
function(a){return String.fromCharCode(a.replace(/[\uff06&#;\uff1b]/g,""))})},converHtmlEntity:function(){return this.replace(configs.regHtmlEntity,function(a,d){return configs.sHtmlEntity[d]?configs.sHtmlEntity[d]:a})},convertVariant:function(){return this.replaces(configs.sVariant)},convertSerialNumber:function(){return this.replaces(configs.sSerialNumber)},convertPunctuation:function(){return this.replaces(configs.punSymbol).replaces(configs.nwSymbol)},replaceSpace:function(){return this.replace(/[\t]+(?=[\u4e00-\u9fa0])/g,
"\n").replace(/[ ]+/g," ").replace(/[ ]+(?=[\u4e00-\u9fa0\u00b7\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2013\u2014\u2018\u2019\u201c\u201d\u2026\u3001\u3002\u3008-\u3011\u3014\u3015\uffe0-\uffe5\uff06\/\\\+\-'])/g,"").replace(/([0-9a-zA-Z])[ ]+([\u4e00-\u9fa0\u00b7\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2013\u2014\u2018\u2019\u201c\u201d\u2026\u3001\u3002\u3008-\u3011\u3014\u3015\uffe0-\uffe5\uff06])/g,"$1$2").replace(/([\u4e00-\u9fa0\u00b7\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2013\u2014\u2018\u2019\u201c\u201d\u2026\u3001\u3002\u3008-\u3011\u3014\u3015\uffe0-\uffe5\uff06])[ ]+([0-9a-zA-Z])/g,
"$1$2")},replaceSeparator:function(){return this.replaces(configs.rSeparator).replace(/!@!@!@!@!/g,"\uff0a".times(35)).replace(/@@@@/g,configs.Separator)},replaceQuotes:function(a,d){a=("fr"!==a?"\u2018\u2019\u201c\u201d":"\u300e\u300f\u300c\u300d").split("");d=d||!1;var b=this.replace(/([a-zA-z])(['`\uff07\u2018\u2019\u300e\u300f])([a-zA-z])/g,"$1\u203b@\u203b$3");d||(b=b.replace(/[\u2018\u2019\u300e\u300f]/g,"'").replace(/[\u201c\u201d\u300c\u300d\[\]]/g,'"'));return b.replace(/[`\uff07]/g,"'").replace(/[\u301d\u301e\uff3b\uff3d\uff02\u2033\uff62\uff63]/g,
'"').replace(/'([^'\r\n]+)'/g,a[0]+"$1"+a[1]).replace(/^([\u3000]+)'/gm,"$1"+a[0]).replace(/'/g,a[1]).replace(new RegExp("^([\u3000]*)"+a[1],"gm"),"$1"+a[0]).replace(new RegExp(a[0]+"$","gm"),a[1]).replace(/\u203b@\u203b/g,"'").replace(/"([^"\r\n]+)"/g,a[2]+"$1"+a[3]).replace(/^([\u3000]+)"/gm,"$1"+a[2]).replace(/"/g,a[3]).replace(new RegExp("^([\u3000]*)"+a[3],"gm"),"$1"+a[2]).replace(new RegExp(a[2]+"$","gm"),a[3]).replace(new RegExp("\uff1a"+a[3],"g"),"\uff1a"+a[2])},replaceTitle:function(a,d,
b,e){var h=configs.Divide,g=a||"\n\n",l=d||"",k=b||!1;a=this;e&&(configs.regSeparator=configs.regSeparatorNull,configs.regStrictEnd=configs.regEnd);e=configs.regTitle;var f=configs.regSeparator;d=configs.regSeparatorNull;k&&(a=a.replace(new RegExp(configs.regStart+configs.Separator,"gm"),function(a){return doCenter(a,"","",k)}));b=["^"+configs.regStart,"","(?:"+d+")","("+configs.regEnd+"|$)","$"];b[1]="("+e.t1.join("|")+")";a=a.replace(new RegExp(b.join(""),"gm"),function(a,b,d){if(d.match(/^[\uff01\uff1f\u3002]{1,3}$/g))return a;
d=d.replace(new RegExp("^"+f,"g"),"").replace(/[\u3010](.*)[\u3011]$/g,"$1").replace(new RegExp("^"+f+"$","g"),"");0<d.length&&(d=h+d);return doCenter(b+d,g,l,k)});a=a.replace(new RegExp("("+e.t1[0]+")"+h+"(\uff08?[0-9\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341]{1,2}\uff09?)","g"),"$1$2");a=a.replace(new RegExp(["^"+configs.regStart,"[\u3010]?"+e.t2+"[\u3011]?","("+d+")","[\u3010]?("+configs.regEnd+"|$)[\u3011]?","$"].join(""),"gm"),function(a){return a.replace(/[\u3010\u3011]/g,
"")});b[1]=e.t2;a=a.replace(new RegExp(b.join(""),"gm"),function(a,b,d,e){if(a.match(configs.regSkipTitle)&&!e.match(configs.regSeparatorCheck)&&e.match(/[\uff01\uff1f\u3002\u2026]{1,3}$/g)||d.match(/^[\-\u2014]/g)||0===e.length&&d.match(/[\uff01\uff1f\u3002\u2026]{1,3}$/g))return a;e=e.replace(new RegExp("^"+f,"g"),"").replace(/([\u4E00-\u9FA5])[ ]+([\u4E00-\u9FA5])/g,"$1\uff0c$2").replace(/([\w]+)[ ]{1,4}([\w]+)/g,"$1 $2").replace(new RegExp("^"+f+"$","g"),"");0<e.length&&(e=h+e);d=d.replace(/[ ]*/g,
"");return doCenter("\u7b2c"+d+e,g,l,k)});b[1]=e.t5;b[2]="";a=a.replace(new RegExp(b.join(""),"gm"),function(a,d,b){b=b.replace(new RegExp("^"+f,"g"),"").replace(/[\u3010](.*)[\u3011]$/g,"$1").replace(new RegExp("^"+f+"|"+f+"$","g"),"");return doCenter(d+b,g,l,k)});if(k)return a;b[1]=e.t3;b[2]="(?:"+d+")";a=a.replace(new RegExp(b.join(""),"gm"),function(a,d,b,e){e=e.replace("^"+new RegExp(f,"g"),"").replace(/[\u3010](.*)[\u3011]$/g,"$1").replace(new RegExp("^"+f+"$","g"),"");0<e.length&&(e=h+e);return g+
"\u7b2c"+b+d+e+l});b[1]=e.t4;b[2]="("+f+"|";b[3]=f+configs.regStrictEnd+"|$)";return a=a.replace(new RegExp(b.join(""),"gm"),function(a,d,b){var e=/^[\d\uff10-\uff19\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341]{1,4}[\u5e74\u6708\u65e5\u70b9\u65f6\u5206\u79d2\u9ede\u6642]([\d\uff10-\uff19\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341]|$)/g,k=/^[\d\uff10-\uff19]{1,2}[:\uff1a][\d\uff10-\uff19]{1,2}[:\uff1a][\d\uff10-\uff19]{1,2}/g,m=/^[\d\uff10-\uff19]{1,6}[%\uff05\u2030\u2103\u00b0]$/g,
n=/^[\d\uff10-\uff19]{1,2}[:\uff1a][\d\uff10-\uff19]{1,2}/g;if(/^([\d\uff10-\uff19]{2,4})[\.\-\/\u3002\u2014][\d\uff10-\uff19]{1,2}[\.\-\/\u3002\u2014][\d\uff10-\uff19]{1,2}/g.test(a)||e.test(a)||k.test(a)||m.test(a)||n.test(a))return a;b=b.replace(new RegExp("^"+f,"g"),"").replace(/[\u3010](.*)[\u3011]$/g,"$1").replace(new RegExp("^"+f+"$","g"),"");0<b.length&&(b=h+b);return g+"\u7b2c"+d+"\u7ae0"+b+l})}});
function doCenter(a,d,b,e){d=d||"\n";b=b||"";e=e||!1;var h=2*configs.Linenum;if(e){a=a.trim();var g=a.len();e&&h>g&&(a="\u3000".times(parseInt((h-g)/4,10))+a)}return d+a+b}
"function"!==typeof Date.prototype.format&&(Date.prototype.format=function(a){var d={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var b in d)(new RegExp("("+b+")")).test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?d[b]:("00"+d[b]).substr((""+d[b]).length)));return a});
"function"!==typeof String.prototype.format&&(String.prototype.format=function(a){if(0===arguments.length)return this;var d=this;if(1===arguments.length&&"object"===typeof a)for(var b in a)void 0!=a[b]&&(d=d.replace(new RegExp("({"+b+"})","g"),a[b]));else for(var e=0;e<arguments.length;e++)void 0!=arguments[e]&&(d=d.replace(new RegExp("({)"+b+"(})","g"),arguments[e]));return d});
"function"!==typeof String.prototype.findCount&&(String.prototype.findCount=function(a){var d=0;this.replace(a,function(){d++});return d});
