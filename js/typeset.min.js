function doSplit(a,e,c){var g="",f=2*configs.Linenum;if(a.match(/^\u3000{2,}/))return a+"\n\n";a=a.trim();if(0===a.len())return a;var h="",d=a==="\uff0a".times(35)?a:"\u3000\u3000"+a;if(d.len()>f){a=Math.floor(d.len()/f)+1;for(c=0;c<a;c++){var b=d.realSubstring(0,f);b=b.replace(/([\u300c\u201c\u300a\u300e\u2018\uff08]){1,2}$/gm,function(a){d+=a;return""});d=d.realSubstring(b.len());d=d.replace(/^([\uff0c\u3002\uff1a\u3001\uff1b\uff1a\uff1f\uff01\uff0e\uff09\u300b\u300d\u300f]{1,2})/gm,function(a){b+=
a;return""});d=d.replace(/^([\u2026\uff5e\uff0d])$/gm,function(a){b+=a;return""});var k=0===b.replace(/[\w]/g,"").replace(configs.Space,"").replace(configs.HWPunctuation,"").replace(configs.FWPunctuation,"").length;b.len()<f&&!k&&(b=b.match(/([\u4e00-\u9fa0\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2018\u2019\u201c\u201d\u3002\u300e\u300f\u300c\u300d])([0-9a-zA-Z])/)?b.replace(/([\u4e00-\u9fa0\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2018\u2019\u201c\u201d\u3002\u300e\u300f\u300c\u300d])([0-9a-zA-Z])/,
"$1 $2"):b.replace(/([0-9a-zA-Z])([\u4e00-\u9fa0\uff01\uff08\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\u2018\u2019\u201c\u201d\u3002\u300e\u300f\u300c\u300d])/,"$1 $2"),b=b.replace(/([\u201c\u2018\u300e\u300c][0-9a-zA-Z ]+[\u300d\u300f\u2019\u201d])/g,function(a){return a.replace(/ /g,"")+" "}));h+=b+"\n"}g+=h+e}else g+=d+c;return g}
function doTidy(a){var e=new RegExp("^[ \u3000]*([\uff08\u3010\u201c\u300c<]?)("+configs.endStrs+")([\uff09\u3011\u201d\u300d>]?)$","gm");a=a.replace(/\u4f5c\u8005\uff1a(.*?)\n([\d\/]*)(\u53d1\u8868\u4e8e|\u767c\u8868\u65bc)\uff1a(.*?)\n\u662f\u5426(\u9996\u53d1|\u9996\u767c)\uff1a(.*?)\n\u5b57[\u6570\u6578]\uff1a(.*?)\n/gm,"").replaceInit().replaces([[/\u201c/g,"\u300c"],[/\u201d/g,"\u300d"],[/\u2018/g,"\u300e"],[/\u2019/g,"\u300f"]]).convertNumberLetter().replaceSeparator();var c=a.split("\n"),
g=c.length;a="";for(var f=0;f<g;f++)a+=doSplit(c[f].trim(),"\n","\n\n");a=a.replace(e,function(a){return a.toTitleCenter("","",!0)}).replaceTitle("","",!0).replace(/^([ \u3000]+)$\n/gm,"").replace(/\n{3,}$/gm,"\n\n").replace(/^\n{2,}/gm,"\n");a="\n"+a;e="\u7b80"!==$("#chinese").html()?"\u4f5c\u8005\uff1a{$w}\n{$d}\u53d1\u8868\u4e8e\uff1a{$b}\n\u662f\u5426\u9996\u53d1\uff1a{$y}\n\u5b57\u6570\uff1a{$n} \u5b57\n":"\u4f5c\u8005\uff1a{$w}\n{$d}\u767c\u8868\u65bc\uff1a{$b}\n\u662f\u5426\u9996\u767c\uff1a{$y}\n\u5b57\u6578\uff1a{$n} \u5b57\n";
e=e.fmt({w:$("#inputAuthor").val().trim()||"",b:$("#inputSite").val().trim()||"",y:$("#Check_0").is(":checked")?"\u662f":"\u5426",d:(new Date).fmt("yyyy/MM/dd"),n:(a.length-a.findCount(allSpace)).fmt()});return e+a}
function editorCleanUp(a){a=a.replaceInit();$("#Check_1").is(":checked")&&(a=a.converHtmlEntity());$("#Check_2").is(":checked")&&(a=a.converUnicode());$("#Check_3").is(":checked")&&(a=a.convertVariant());$("#Check_4").is(":checked")&&(a=a.convertSerialNumber());$("#Check_6").is(":checked")&&(a=a.convertNumberLetter());$("#Check_7").is(":checked")&&(a=a.replaceTitle());$("#Check_5").is(":checked")&&(a=a.convertPunctuation());$("#Check_8").is(":checked")&&(a=a.replaceSpace());$("#Check_9").is(":checked")&&
(a=a.replaceSeparator());$("#Check_10").is(":checked")&&(a=a.replaceQuotes("fr"));$("#Check_11").is(":checked")&&(a=a.convertInitial());return a.replaceEnd()}
function setTitle(){var a=$("#inputBookName").val(),e=$("#inputChapter").val(),c="";0<a.length&&(c="\u3010"+a.trim().replace(/(^[\uff08\u3010\u201c\u300c<]|[\uff09\u3011\u201d\u300d>]$)/g,"")+"\u3011");0<e.length&&(c+="\uff08"+e.trim().replace(/(^[\uff08\u3010\u201c\u300c<]|[\uff09\u3011\u201d\u300d>]$)/g,"")+"\uff09");$("#TitleMsg").html(c||$("#TitleMsg").attr("data-tip"))};
