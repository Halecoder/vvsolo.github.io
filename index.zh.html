<!DOCTYPE html>
<html lang="UTF-8">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="排版助手（在線版）">
  <meta name="author" content="vsolo">
  <title>排版助手（在線版）</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <style>
    html,
    body {
      font-size: 12px;
      background-color: #fafafa;
    }
    #copyTitle {
      cursor: pointer;
      font-weight: normal;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">排版助手（在線版）</a>
    <ul class="navbar-nav justify-content-end">
      <li class="nav-item active">
        <a class="nav-link" href="./index.html">访问简体版</a>
      </li>
    </ul>
  </nav>
  <div class="container-fluid" style="margin:20px 0;">
    <div class="row">
      <div class="col-2">

        <div class="container-fluid">
          <div class="alert alert-primary" role="alert">
            <strong>標頭設置</strong>
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">書名</div>
            </div>
            <input type="text" class="form-control" id="inputBookName" placeholder="小說名稱">
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">章節</div>
            </div>
            <input type="text" class="form-control" id="inputChapter" placeholder="例：01-10、第01章">
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">作者</div>
            </div>
            <input type="text" class="form-control" id="inputAuthor" placeholder="作者名稱">
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">首發</div>
            </div>
            <input type="text" class="form-control" id="inputSite" placeholder="首發站點">
          </div>
          <div class="alert alert-primary" role="alert">
            <strong>格式設置</strong>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_0">
              <label class="form-check-label" for="Check_0">HTML字元實體轉換</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_1">
              <label class="form-check-label" for="Check_1">Unicode轉換</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_2">
              <label class="form-check-label" for="Check_2">轉換變體字母</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_3">
              <label class="form-check-label" for="Check_3">轉換變體序號</label>
            </div>
          </div>
          <hr />
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_5" checked>
              <label class="form-check-label" for="Check_5">全形所有標點符號</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_4" checked>
              <label class="form-check-label" for="Check_4">半形所有字母數字</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_10" checked>
              <label class="form-check-label" for="Check_10">英文首字大寫</label>
            </div>
          </div>
          <hr />
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_6" checked>
              <label class="form-check-label" for="Check_6">修正章節標題</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_7" checked>
              <label class="form-check-label" for="Check_7">去除漢字間的空格</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_8" checked>
              <label class="form-check-label" for="Check_8">修正分隔符號</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_9" checked>
              <label class="form-check-label" for="Check_9">修正引號</label>
            </div>
          </div>
          <hr />
          <div class="input-group mb-2">
            <button type="button" class="btn btn-primary" title="保存設置到 Cookies" id="SaveConfig">保存設置</button>
          </div>
        </div>
      </div>
      <div class="col-10">
        <div class="container-fluid" style="padding-bottom:40px">
          <div class="alert alert-warning" role="alert">
            <h5 class="alert-heading">
              <span id="TitleMsg">此處標題</span>
              <span title="複製標題到剪貼板" class="badge badge-secondary" id="copyTitle">複製</span>
            </h5>
            <input type="text" style="position: absolute; left: -1000px;" id="TitleContent" value="">
            <hr />
            <span id="AlertMsg" data-doc="">填寫作者等相關訊息後，“一鍵整理” → “排版輸出”.</span>
            <span class="float-right"><strong id="CountMsg">0</strong> 位元組</span>
          </div>
          <div>
            <div class="float-left">
              <button type="button" class="btn btn-success" title="一鍵整理" id="onCleanUp">一鍵整理</button>
              <button type="button" class="btn btn-success" title="排版輸出" id="onTypeSet">排版輸出</button>
              <button type="button" class="btn btn-secondary" title="複製文件到剪貼板" id="onCopy">複製文件</button>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary" title="轉換簡體" id="toSimp"><strong>簡</strong></button>
                <button type="button" class="btn btn-outline-secondary" title="轉換繁體" id="toTrad"><strong>繁</strong></button>
              </div>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary" title="加粗" data-ubbcode="[b]{s}[/b]"><strong>B</strong></button>
                <button type="button" class="btn btn-outline-secondary" title="下劃線" data-ubbcode="[u]{s}[/u]"><strong><u>U</u></strong></button>
                <button type="button" class="btn btn-outline-secondary" title="斜體" data-ubbcode="[i]{s}[/i]"><strong><em>I</em></strong></button>
              </div>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary" title="插入待續" data-insert="（待續）"><strong>續</strong></button>
                <button type="button" class="btn btn-outline-secondary" title="插入全文完" data-insert="（全文完）"><strong>完</strong></button>
              </div>
            </div>
            <div class="float-right">
              <button type="button" class="btn btn-primary" title="臨時保存文件" id="SaveEditor">保存</button>
              <button type="button" class="btn btn-info" title="還原臨時文件" id="RestoreEditor">還原</button>
              <button type="button" class="btn btn-danger" title="清空文件" id="ClearEditor">清空</button>
            </div>
          </div>
        </div>
        <div class="container-fluid">
          <textarea class="form-control" id="TextareaEditor" style="min-height:480px;background-color: #f2f2f2;font-family: '思源宋体', '新宋体', '宋体';font-size: 13px;" placeholder="黏貼文本到此處" data-lang=""></textarea>
        </div>
    </div>
  </div>
  <!-- /.container -->

  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="js/jquery.shortcuts.js"></script>

  <script src="js/config.js"></script>
  <script src="js/typesetting.min.js"></script>
  <script src="js/typeset.js"></script>
  <script src="js/conver.dic.js"></script>
  <script>
    $(function() {
      // 讀取保存的設置
      $('#inputBookName').val($.cookie('inputBookName') || '')
      $('#inputChapter').val($.cookie('inputChapter') || '')
      $('#TitleMsg').html(getTitle('此處標題'))
      $('#inputAuthor').val($.cookie('inputAuthor') || '')
      $('#inputSite').val($.cookie('inputSite') || '')
      for (var i = 0; i < 4; i++) {
        var tmp = 'Check_' + i;
        if ($.cookie(tmp)) {
          $('#' + tmp).removeAttr('checked').attr('checked', 'checked')
        } else {
          $('#' + tmp).removeAttr('checked')
        }
      }
      // 保存設置
      $('#SaveConfig').click(function() {
        $.cookie('inputBookName', $('#inputBookName').val(), { expires: 365 })
        $.cookie('inputChapter', $('#inputChapter').val(), { expires: 365 })
        $.cookie('inputAuthor', $('#inputAuthor').val(), { expires: 365 })
        $.cookie('inputSite', $('#inputSite').val(), { expires: 365 })
        for (var i = 0; i < 4; i++) {
          var tmp = 'Check_' + i;
          if ($('#' + tmp).is(':checked'))
            $.cookie(tmp, 'checked', { expires: 365 })
          else {
            $.removeCookie(tmp)
          }
        }
        $('#AlertMsg').html('設置已保存！')
      })
      // 按鈕
      var tEditor = $('#TextareaEditor')
      tEditor.focus()
      // 轉簡體
      $('#toSimp').click(function() {
        tEditor.val(Othered(Simplized(tEditor.val())))
      })
      // 轉繁體
      $('#toTrad').click(function() {
        tEditor.val(Traditionalized(tEditor.val()))
      })
      // 即時統計字元
      tEditor.on('keyup keydown change focus', function() {
        $('#CountMsg').html(tEditor.val().length)
      })
      // 即時顯示文章標題
      $('#inputBookName,#inputChapter').on('keyup keydown change focus', function() {
        $('#TitleMsg').html(getTitle('此處標題'))
      })
      // 清空文件
      $('#ClearEditor').click(function() {
        tEditor.val('').focus()
      });
      // 保存文件
      $('#SaveEditor').click(function() {
        var sEditor = tEditor.val()
        if (sEditor.length > 0) {
          $('#AlertMsg').data('doc', sEditor)
          $('#AlertMsg').html('文件已保存！')
        }
        tEditor.focus()
      });
      // 還原文件
      $('#RestoreEditor').click(function() {
        var sEditor = $('#AlertMsg').data('doc')
        if (sEditor.length > 0) {
          tEditor.val(sEditor)
          $('#AlertMsg').html('文件已還原！')
        }
        tEditor.focus()
      });
      // 一鍵整理
      $('#onCleanUp').click(function() {
        var sVal = tEditor.val()
        if (sVal.length > 0) {
          tEditor.val(getCleanUp(sVal))
          tEditor.focus()
        }
      })
      // 一鍵排版
      $('#onTypeSet').click(function() {
        var sVal = tEditor.val()
        if (sVal.length > 0) {
          $('#AlertMsg').data('doc', sVal)
          $('#AlertMsg').html('排版成功！原格式文件已保存，若想重排請點擊“還原”按鈕！')
          tEditor.val(doTidy(sVal))
          tEditor.focus()
        }
      })
      // 簡單UBB
      $('.btn[data-ubbcode]').each(function() {
        var $this = $(this)
        $this.click(function() {
          if (tEditor.selectionRange().length > 0) {
            var tmp = $this.data('ubbcode').replace(/\{s\}/g, tEditor.selectionRange())
            tEditor.insertContent(tmp)
            $('#AlertMsg').html('標題已' + $this.attr('title') + '！')
          } else {
            $('#AlertMsg').html('未選中文字！')
          }
        })
      })
      // 插入待續完結
      $('.btn[data-insert]').each(function() {
        var $this = $(this)
        $this.click(function() {
          var tmp = $this.data('insert')
          tEditor.insertContent(tmp)
        })
      })
      // 複製標題到剪貼板
      $('#copyTitle').click(function() {
        var sVal = $('#TitleMsg').text()
        if (sVal.length > 0) {
          $('#TitleContent').val(sVal)
          $('#TitleContent').select()
          document.execCommand('Copy')
          $('#AlertMsg').html('標題已複製到剪貼板！')
        }
      })
      // 複製文章到剪貼板
      $('#onCopy').click(function() {
        var sVal = tEditor.val()
        if (sVal.length > 0) {
          tEditor.focus().select()
          document.execCommand('Copy')
          tEditor.blur()
          $('#AlertMsg').html('文件已複製到剪貼板！')
        }
      });
    });
  </script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4e383017601b1ea13cab1d5efbae8584";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>

</html>