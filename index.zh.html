<!DOCTYPE html>
<html lang="UTF-8">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="排版助手（在線版）">
  <meta name="author" content="vsolo">
  <title>排版助手（在線版）</title>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <style>
    html,
    body {
      font-size: 12px;
      background-color: #fafafa;
    }
    .btn-copy {
      cursor: pointer;
      font-weight: normal;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="https://github.com/vvsolo/vvsolo.github.io" title="View on GitHub">排版助手（在線版）</a>
    <ul class="navbar-nav justify-content-end">
      <li class="nav-item active">
        <a class="nav-link text-warning" href="./">訪問繁體版</a>
      </li>
    </ul>
  </nav>
  <div class="container-fluid" style="margin:20px 0;">
    <div class="row">
      <div class="col-2">

        <div class="container-fluid">
          <div class="alert alert-primary" role="alert">
            <strong>標頭設置</strong>
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">書名</div>
            </div>
            <input type="text" class="form-control" id="inputBookName" placeholder="小說名稱">
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">章節</div>
            </div>
            <input type="text" class="form-control" id="inputChapter" placeholder="更新章節">
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">作者</div>
            </div>
            <input type="text" class="form-control" id="inputAuthor" placeholder="作者名稱">
          </div>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">首發</div>
            </div>
            <input type="text" class="form-control" id="inputSite" placeholder="首發站點">
          </div>
          <div class="alert alert-primary" role="alert">
            <strong>格式設置</strong>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_0">
              <label class="form-check-label" for="Check_0">修正 HTML 字元實體</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_1">
              <label class="form-check-label" for="Check_1">修正 Unicode</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_2">
              <label class="form-check-label" for="Check_2">修正變體字母</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_3">
              <label class="form-check-label" for="Check_3">修正變體序號</label>
            </div>
          </div>
          <hr />
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_5" checked>
              <label class="form-check-label" for="Check_5">全形標點符號</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_4" checked>
              <label class="form-check-label" for="Check_4">半形字母數字</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_10" checked>
              <label class="form-check-label" for="Check_10">英文首字大寫</label>
            </div>
          </div>
          <hr />
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_6" checked>
              <label class="form-check-label" for="Check_6">修正章節標題</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_7" checked>
              <label class="form-check-label" for="Check_7">修正漢字空格</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_8" checked>
              <label class="form-check-label" for="Check_8">修正分隔符號</label>
            </div>
          </div>
          <div class="input-group mb-2">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="Check_9" checked>
              <label class="form-check-label" for="Check_9">修正引用符號</label>
            </div>
          </div>
          <hr />
          <div class="input-group mb-2">
            <button type="button" class="btn btn-primary" title="保存設置到 Cookies" id="SaveConfig">保存設置</button>
          </div>
        </div>
      </div>
      <div class="col-10">
        <div class="container-fluid" style="padding-bottom:40px">
          <div class="alert alert-warning" role="alert">
            <h5 class="alert-heading">
              <span id="TitleMsg">此處標題</span>
              <span title="複製標題到剪貼板" class="badge badge-secondary btn-copy" data-clipboard-target="#TitleMsg">複製</span>
            </h5>
            <hr />
            <span id="AlertMsg" data-doc="">填寫作者等相關訊息後，“一鍵整理” → “排版輸出”.</span>
            <span class="float-right" id="CountMsg"><strong>0</strong> 行/<strong>0</strong> 位元組</span>
          </div>
          <div>
            <div class="float-left">
              <button type="button" class="btn btn-success" title="一鍵整理" id="onCleanUp">一鍵整理</button>
              <button type="button" class="btn btn-success" title="排版輸出" id="onTypeSet">排版輸出</button>
              <button type="button" class="btn btn-secondary btn-copy" title="複製文件到剪貼板" data-clipboard-target="#TextareaEditor">複製文件</button>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="轉換簡體" id="toSimp">簡</button>
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="轉換繁體" id="toTrad">繁</button>
              </div>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="加粗" data-ubbcode="[b]{s}[/b]">B</button>
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="下劃線" data-ubbcode="[u]{s}[/u]"><u>U</u></button>
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="斜體" data-ubbcode="[i]{s}[/i]"><em>I</em></button>
              </div>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="插入待續" data-insert="（待續）">續</button>
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="插入全文完" data-insert="（全文完）">完</button>
              </div>
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-secondary font-weight-bold" title="顯隱輔助線" data-subline>輔</button>
              </div>
            </div>
            <div class="float-right">
              <button type="button" class="btn btn-primary" title="保存臨時文件" id="SaveEditor">保存</button>
              <button type="button" class="btn btn-info" title="還原臨時文件" id="RestoreEditor">還原</button>
              <button type="button" class="btn btn-danger" title="清空文件" id="ClearEditor">清空</button>
            </div>
          </div>
        </div>
        <div class="container-fluid">
          <textarea class="form-control" id="TextareaEditor" style="min-height: 480px;background-color: #f2f2f2;font-family: '新宋体', '宋体';font-size: 14px;font-weight: bold;" placeholder="黏貼文本到此處" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
        </div>
        <div id="subline" style="position: absolute;width: 0px;border-right: 2px dashed #B8DAFF;height: 478px;"></div>
    </div>
  </div>
  <!-- /.container -->

  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="https://cdn.bootcss.com/clipboard.js/2.0.1/clipboard.min.js"></script>
  <script src="js/jquery.shortcuts.js?201809"></script>
  <script src="js/jquery.TextareaLine.js?201809"></script>

  <script src="js/config.js?201809"></script>
  <script src="js/typesetting.min.js?201809"></script>
  <script src="js/typeset.js?201809"></script>
  <script src="js/conver.dic.js?201809"></script>
  <script>
    $(function() {
      // 讀取保存的設置
      $('#inputBookName').val($.cookie('inputBookName') || '')
      $('#inputChapter').val($.cookie('inputChapter') || '')
      $('#TitleMsg').html(getTitle('此處標題'))
      $('#inputAuthor').val($.cookie('inputAuthor') || '')
      $('#inputSite').val($.cookie('inputSite') || '')
      for (var i = 0; i < 4; i++) {
        var tmp = 'Check_' + i;
        if ($.cookie(tmp)) {
          $('#' + tmp).removeAttr('checked').attr('checked', 'checked')
        } else {
          $('#' + tmp).removeAttr('checked')
        }
      }
      // 保存設置
      $('#SaveConfig').click(function() {
        $.cookie('inputBookName', $('#inputBookName').val(), { expires: 365 })
        $.cookie('inputChapter', $('#inputChapter').val(), { expires: 365 })
        $.cookie('inputAuthor', $('#inputAuthor').val(), { expires: 365 })
        $.cookie('inputSite', $('#inputSite').val(), { expires: 365 })
        for (var i = 0; i < 4; i++) {
          var tmp = 'Check_' + i;
          if ($('#' + tmp).is(':checked'))
            $.cookie(tmp, 'checked', { expires: 365 })
          else {
            $.removeCookie(tmp)
          }
        }
        $('#AlertMsg').html('設置已保存！')
      })
      // 按鈕
      var tEditor = $('#TextareaEditor')
      // 行號
      tEditor.TextareaLine().focus()
      // 輔助線
      var position = tEditor.position()
      $('#subline').offset({ top: position.top + 63, left: 842})
      $('[data-subline]').click(function() {
        $('#subline').toggle()
      })
      // 轉簡體
      $('#toSimp').click(function() {
        tEditor.val(Othered(Simplized(tEditor.val()))).focus()
      })
      // 轉繁體
      $('#toTrad').click(function() {
        tEditor.val(Traditionalized(tEditor.val())).focus()
      })
      // 即時統計字元
      tEditor.on('keyup keydown change focus input propertychange', function() {
	    var sVal = tEditor.val()
        $('#CountMsg').find('strong:eq(0)').html(sVal.length > 0 ? sVal.split('\n').length : 0)
        $('#CountMsg').find('strong:eq(1)').html(sVal.length)
      })
      // 即時顯示文章標題
      $('#inputBookName,#inputChapter').on('keyup keydown change focus input propertychange', function() {
        $('#TitleMsg').html(getTitle('此處標題'))
      })
      // 清空文件
      $('#ClearEditor').click(function() {
        tEditor.val('').focus()
      });
      // 保存文件
      $('#SaveEditor').click(function() {
        var sVal = tEditor.val()
        if (sVal.length > 0) {
          $('#AlertMsg').data('doc', sVal).html('文件已保存！')
        }
        tEditor.focus()
      });
      // 還原文件
      $('#RestoreEditor').click(function() {
        var sVal = $('#AlertMsg').data('doc')
        if (sVal.length > 0) {
          tEditor.val(sVal).focus()
          $('#AlertMsg').html('文件已還原！')
        }
      });
      // 一鍵整理
      $('#onCleanUp').click(function() {
        var sVal = tEditor.val()
        if (sVal.length > 0) {
          tEditor.val(getCleanUp(sVal)).focus()
        }
      })
      // 一鍵排版
      $('#onTypeSet').click(function() {
        var sVal = tEditor.val()
        if (sVal.length > 0) {
          $('#AlertMsg').data('doc', sVal).html('排版成功！原格式文件已保存，若想重排請點擊“還原”按鈕！')
          tEditor.val(doTidy(sVal)).focus()
        }
      })
      // 簡單UBB
      $('.btn[data-ubbcode]').each(function() {
        var $this = $(this)
        $this.click(function() {
          if (tEditor.selectionRange().length > 0) {
            var tmp = $this.data('ubbcode').replace(/\{s\}/g, tEditor.selectionRange())
            tEditor.insertContent(tmp)
          } else {
            $('#AlertMsg').html('未選中文字！')
          }
        })
      })
      // 插入待續完結
      $('.btn[data-insert]').each(function() {
        var tmp = $(this).data('insert')
        $(this).click(function() {
          tEditor.insertContent(tmp)
        })
      })
      // 複製到剪貼板
      var clipboard = new ClipboardJS('.btn-copy')
      clipboard.on('success', function(e) {
        $('#AlertMsg').html('複製成功！')
        e.clearSelection()
      });
    });
  </script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4e383017601b1ea13cab1d5efbae8584";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>

</html>